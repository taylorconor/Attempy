{% extends "base.html" %}

{% block title %}
Editor
{% endblock %}

{% block head %}
<style type="text/css" media="screen">
    #editor {
        display: inline;
        height: 725px;
    }

    #folder-sidebar{
        top: 0;
        left: 0;
        display: inline;
        height: 725px;
        border-radius: 0px !important;
    }

    #folder-sidebar .nav-header{
        cursor: pointer;
    }
</style>
{% endblock %}

{% block content %}
<div class="row">
  <div id="folder-sidebar" class="well col-xs-1.5 pull-left">
        <ul class="nav nav-list">
            <li><label class="tree-toggle nav-header">Bootstrap</label>
                <ul class="nav nav-list tree">
                    <li><a href="#">JavaScript</a></li>
                    <li><a href="#">CSS</a></li>
                    <li><label class="tree-toggle nav-header">Buttons</label>
                        <ul class="nav nav-list tree">
                            <li><a href="#">Colors</a></li>
                            <li><a href="#">Sizes</a></li>
                            <li><label class="tree-toggle nav-header">Forms</label>
                                <ul class="nav nav-list tree">
                                    <li><a href="#">Horizontal</a></li>
                                    <li><a href="#">Vertical</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li class="divider"></li>
            <li><label class="tree-toggle nav-header">Responsive</label>
                <ul class="nav nav-list tree">
                    <li><a href="#">Overview</a></li>
                    <li><a href="#">CSS</a></li>
                    <li><label class="tree-toggle nav-header">Media Queries</label>
                        <ul class="nav nav-list tree">
                            <li><a href="#">Text</a></li>
                            <li><a href="#">Images</a></li>
                            <li><label class="tree-toggle nav-header">Mobile Devices</label>
                                <ul class="nav nav-list tree">
                                    <li><a href="#">iPhone</a></li>
                                    <li><a href="#">Samsung</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li><label class="tree-toggle nav-header">Coding</label>
                        <ul class="nav nav-list tree">
                            <li><a href="#">JavaScript</a></li>
                            <li><a href="#">jQuery</a></li>
                            <li><label class="tree-toggle nav-header">HTML DOM</label>
                                <ul class="nav nav-list tree">
                                    <li><a href="#">DOM Elements</a></li>
                                    <li><a href="#">Recursive</a></li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </li>
        </ul>
    </div>
    <div id="editor" class="col-xs-10 pull-left"></div>
</div>

<textarea id="file_name" style="display:none;">TEMPORARY_FILE_NAME.pml</textarea>
<button type="submit" id="submit_save" class="btn btn-default">Save</button>

<script src="{{ url_for('static', filename='ace/build/src/ace.js') }}"
        type="text/javascript" charset="utf-8"></script>
<script>
    var editor = ace.edit("editor");
    // dark theme
    editor.setTheme("ace/theme/monokai");
    editor.getSession().setMode("ace/mode/javascript");
    // keybindings for search and replace (win == linux)
    editor.commands.addCommand({
        name: 'replace',
        bindKey: {win: 'Ctrl-R', mac: 'Command-alt-F'},
        exec: function(editor) {
            ace.config.loadModule("ace/ext/searchbox", function(e) {e.Search(editor, true)});
        },
        readOnly: true
    });
</script>
<script>
$(document).ready(function() {
    $('#submit_save').on('click', function() {
        $.ajax({
            url: "{{ url_for('home.pml_save_file') }}",
            method: "POST",
            data: {
                data: $('#file_name').val()
            },
            success: function(data) {
                alert(data.output);
            }
        });
    });
});
$.ajax({
    url: "{{ url_for('home.pml_load_file_sidebar') }}",
    method: "GET",
    success: function(data) {
        $('#folder-sidebar').html(data.output);
        $('.tree-toggle').click(function () {
            $(this).parent().children('ul.tree').toggle(200);
        });
    }
});
</script>
{% endblock %}